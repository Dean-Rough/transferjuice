{"version":3,"names":["cov_1l21obdbp7","actualCoverage","BriefingUtils","s","formatTitle","date","funnyTitle","f","days","months","day","getDay","hour","getHours","toString","padStart","month","getMonth","year","getFullYear","slice","full","concat","slug","getDate","funny","timestamp","extractPlayerMentions","content","commonPlayers","filter","player","toLowerCase","includes","generateSlug","calculateReadTime","wordCount","wordsPerMinute","Math","ceil","meetsQualityStandards","briefing","config","_ref","metadata","_ref2","qualityThresholds","targetWordCount","b","min","max","terryScore","minTerryScore","qualityMetrics","factualAccuracy","minFactualAccuracy","brandVoice","minBrandVoice","coherence","minCoherence","DEFAULT_BRIEFING_CONFIG","ideal","contentMix","maxPartnerContentRatio","minShitTierMockery","preferredSections","polaroidSettings","maxPerBriefing","rotationRange","triggerThreshold"],"sources":["briefing.ts"],"sourcesContent":["/**\n * Transfer Juice Briefing System Types\n * Defines the structure for hourly editorial briefings\n */\n\nexport interface BriefingSection {\n  id: string;\n  type: \"lead\" | \"context\" | \"analysis\" | \"bullshit_corner\";\n  title: string;\n  content: string;\n  order: number;\n  sourceTweets: string[]; // Tweet IDs used in this section\n  terryisms: string[]; // Specific Terry phrases used\n  playerMentions: string[]; // For polaroid triggering\n  partnerSources?: string[]; // Partner content references\n}\n\nexport interface BriefingMetadata {\n  wordCount: number;\n  estimatedReadTime: number; // minutes\n  terryScore: number; // 0-100, how Terry-esque it is\n  qualityMetrics: {\n    coherence: number; // 0-100\n    factualAccuracy: number; // 0-100\n    brandVoice: number; // 0-100\n    readability: number; // 0-100\n  };\n  generationTime: number; // milliseconds\n  sourceStats: {\n    totalTweets: number;\n    tier1Sources: number;\n    tier2Sources: number;\n    tier3Sources: number;\n    shitTierSources: number;\n  };\n}\n\nexport interface BriefingTitle {\n  full: string; // Complete title with format\n  funny: string; // Just the Terry humor part\n  day: string; // \"Monday\"\n  hour: string; // \"14:00\"\n  month: string; // \"May\"\n  year: string; // \"'25\"\n  timestamp: Date;\n  slug: string; // URL-friendly version\n}\n\nexport interface PolaroidImage {\n  filename: string;\n  playerName: string;\n  rotation: number; // -8 to +8 degrees\n  position: number; // Scroll position where it appears\n  altText: string;\n  source: \"wikipedia\" | \"manual\" | \"generated\";\n}\n\nexport interface BriefingSharing {\n  platforms: {\n    twitter: {\n      message: string;\n      hashtags: string[];\n      quote?: string; // Featured Terry quote\n    };\n    linkedin: {\n      message: string;\n      description: string;\n    };\n    whatsapp: {\n      message: string;\n    };\n    email: {\n      subject: string;\n      preview: string;\n    };\n  };\n  shareCount: {\n    twitter: number;\n    linkedin: number;\n    whatsapp: number;\n    email: number;\n    copyLink: number;\n  };\n  quotes: string[]; // Shareable Terry quotes\n}\n\nexport interface Briefing {\n  id: string;\n  title: BriefingTitle;\n  timestamp: Date;\n  published: boolean;\n\n  // Content structure\n  sections: BriefingSection[];\n  summary: string;\n  metaDescription: string;\n\n  // Visual elements\n  polaroids: PolaroidImage[];\n  featuredImage?: string;\n\n  // Metadata\n  metadata: BriefingMetadata;\n\n  // Engagement\n  sharing: BriefingSharing;\n  tags: {\n    clubs: string[];\n    players: string[];\n    sources: string[];\n    leagues: string[];\n    transferTypes: string[];\n  };\n\n  // SEO\n  slug: string;\n  canonicalUrl: string;\n  openGraph: {\n    title: string;\n    description: string;\n    image: string;\n    type: \"article\";\n  };\n\n  // Analytics\n  engagement?: {\n    views: number;\n    readTime: number; // actual average read time\n    shares: number;\n    reactions: number;\n    newsletterSignups: number; // from this briefing\n  };\n}\n\nexport interface BriefingArchive {\n  briefings: Briefing[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    hasMore: boolean;\n  };\n  filters: {\n    dateRange?: {\n      start: Date;\n      end: Date;\n    };\n    tags?: string[];\n    leagues?: string[];\n    minReadTime?: number;\n    maxReadTime?: number;\n  };\n}\n\nexport interface BriefingGenerationConfig {\n  targetWordCount: {\n    min: number;\n    max: number;\n    ideal: number;\n  };\n  qualityThresholds: {\n    minTerryScore: number;\n    minFactualAccuracy: number;\n    minBrandVoice: number;\n    minCoherence: number;\n  };\n  contentMix: {\n    maxPartnerContentRatio: number; // 0-1\n    minShitTierMockery: number; // minutes of content\n    preferredSections: BriefingSection[\"type\"][];\n  };\n  polaroidSettings: {\n    maxPerBriefing: number;\n    rotationRange: {\n      min: number; // -8\n      max: number; // +8\n    };\n    triggerThreshold: number; // minimum player mentions to trigger polaroid\n  };\n}\n\n// Helper types for briefing generation\nexport type BriefingStatus =\n  | \"draft\"\n  | \"generating\"\n  | \"reviewing\"\n  | \"published\"\n  | \"failed\";\n\nexport interface BriefingJob {\n  id: string;\n  status: BriefingStatus;\n  scheduledFor: Date;\n  startedAt?: Date;\n  completedAt?: Date;\n  error?: string;\n  config: BriefingGenerationConfig;\n  result?: Briefing;\n}\n\n// Utility functions for working with briefings\nexport const BriefingUtils = {\n  // Generate title format: \"Monday 14:00 Briefing May '25 - [Funny Title]\"\n  formatTitle: (date: Date, funnyTitle: string): BriefingTitle => {\n    const days = [\n      \"Sunday\",\n      \"Monday\",\n      \"Tuesday\",\n      \"Wednesday\",\n      \"Thursday\",\n      \"Friday\",\n      \"Saturday\",\n    ];\n    const months = [\n      \"Jan\",\n      \"Feb\",\n      \"Mar\",\n      \"Apr\",\n      \"May\",\n      \"Jun\",\n      \"Jul\",\n      \"Aug\",\n      \"Sep\",\n      \"Oct\",\n      \"Nov\",\n      \"Dec\",\n    ];\n\n    const day = days[date.getDay()];\n    const hour = date.getHours().toString().padStart(2, \"0\") + \":00\";\n    const month = months[date.getMonth()];\n    const year = \"'\" + date.getFullYear().toString().slice(-2);\n\n    const full = `${day} ${hour} Briefing ${month} ${year} - ${funnyTitle}`;\n    const slug = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, \"0\")}-${date.getDate().toString().padStart(2, \"0\")}-${date.getHours().toString().padStart(2, \"0\")}`;\n\n    return {\n      full,\n      funny: funnyTitle,\n      day,\n      hour,\n      month,\n      year,\n      timestamp: date,\n      slug,\n    };\n  },\n\n  // Extract player mentions from content for polaroid triggering\n  extractPlayerMentions: (content: string): string[] => {\n    // This would be enhanced with a proper player database\n    const commonPlayers = [\n      \"Haaland\",\n      \"Mbappe\",\n      \"Bellingham\",\n      \"Kane\",\n      \"Salah\",\n      \"Vinicius\",\n      \"Pedri\",\n      \"Gavi\",\n      \"Musiala\",\n      \"Camavinga\",\n      \"Osimhen\",\n      \"Leao\",\n      \"Kvaratskhelia\",\n      \"Vlahovic\",\n      \"Saka\",\n      \"Foden\",\n      \"Wirtz\",\n      \"Moukoko\",\n    ];\n\n    return commonPlayers.filter((player) =>\n      content.toLowerCase().includes(player.toLowerCase())\n    );\n  },\n\n  // Generate slug for URL\n  generateSlug: (date: Date): string => {\n    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, \"0\")}-${date.getDate().toString().padStart(2, \"0\")}-${date.getHours().toString().padStart(2, \"0\")}`;\n  },\n\n  // Calculate estimated read time\n  calculateReadTime: (wordCount: number): number => {\n    const wordsPerMinute = 200; // Average reading speed\n    return Math.ceil(wordCount / wordsPerMinute);\n  },\n\n  // Check if briefing meets quality standards\n  meetsQualityStandards: (\n    briefing: Briefing,\n    config: BriefingGenerationConfig\n  ): boolean => {\n    const { metadata } = briefing;\n    const { qualityThresholds, targetWordCount } = config;\n\n    return (\n      metadata.wordCount >= targetWordCount.min &&\n      metadata.wordCount <= targetWordCount.max &&\n      metadata.terryScore >= qualityThresholds.minTerryScore &&\n      metadata.qualityMetrics.factualAccuracy >=\n        qualityThresholds.minFactualAccuracy &&\n      metadata.qualityMetrics.brandVoice >= qualityThresholds.minBrandVoice &&\n      metadata.qualityMetrics.coherence >= qualityThresholds.minCoherence\n    );\n  },\n};\n\n// Default configuration for briefing generation\nexport const DEFAULT_BRIEFING_CONFIG: BriefingGenerationConfig = {\n  targetWordCount: {\n    min: 1200,\n    max: 2500,\n    ideal: 1800,\n  },\n  qualityThresholds: {\n    minTerryScore: 85,\n    minFactualAccuracy: 80,\n    minBrandVoice: 90,\n    minCoherence: 85,\n  },\n  contentMix: {\n    maxPartnerContentRatio: 0.25, // 25% max partner content\n    minShitTierMockery: 2, // At least 2 minutes of Fechejes mockery\n    preferredSections: [\"lead\", \"context\", \"analysis\", \"bullshit_corner\"],\n  },\n  polaroidSettings: {\n    maxPerBriefing: 8,\n    rotationRange: {\n      min: -8,\n      max: 8,\n    },\n    triggerThreshold: 1, // 1+ mentions triggers polaroid\n  },\n};\n"],"mappings":"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","ignoreList":[]}